Из газеты Move #08, Минск, 19.07.1997



                 ХАКЕРАМ
------------------------------------------
       Строение стандартной дорожки.
 
    При   записи  информации  на  диск  по
методу      модифицированной     частотной
модуляции   (MFM)  поступающая  информация
представляет    собой   последовательность
байтов,   каждый  бит  которых  кодируется
следующим  образом.  Головка  дисковода  в
процессе   записи   формирует  на  дорожке
намагниченные   точки   (домены),   причем
домены      бывают     положительные     и
отрицательные   (различаются  направлением
магнитного  потока  в  головке дисковода).
Каждый  бит  состоит  из двух доменов. При
этом     единичный    бит    состоит    из
отрицательного   и  положительного  домена
(-,+); нулевой бит, следующий за единичным
состоит   из  двух  отрицательных  доменов
(-,-); а ноль следующий за нулем из (+,-).
Пример:   последовательность   битов  1001
схематично     представляется    следующим
образом: -+,--,+-,-+.
    Одной  из  особенностей (MFM) является
то,   что   последовательность  одинаковых
битов     может     читаться     и     как
последовательность     нулей     и     как
последовательность  единиц,  в зависимости
от того, в какой момент контролер начал ее
читать.    Неправильное    чтение    битов
называется  сбоем  синхронизации. Чем выше
плотность  записи  на  дорожку, тем меньше
расстояние     между     синхронизирующими
доменами.  Кроме  описанных информационных
байтов,  контроллер  записывает на дорожку
особые  байты,  называемые маркерными. Эти
байты  отличаются  от  информационных тем,
что  в них есть последовательности из трех
нулевых    битов,    второй   из   которых
записывается  так,  как  если бы перед ним
была  единица.  Это  единственный  случай,
когда    на   дорожку   записываются   три
отрицательных домена подряд.
    Маркерные    байты   являются   частью
адресных     маркеров     (AM),    которые
записываются    на    дорожку    при    ее
форматировании    и    предназначены   для
обозначения  начала  дорожки  и  секторов.
Каждый  адресный  маркер  состоит  из  3-х
особых    маркерных    байтов    и   байта
идентификатора   маркера.   Перед   каждым
маркером      записывается     настроечная
последовательность  из  12 нулевых байтов,
которая     предназначена    для    точной
подстройки  частоты внутреннего кварцевого
генератора  контроллера  в  соответствии с
конкретной  частотой  прохождения  доменов
синхронизации   под   головкой   дисковода
(захвата частоты и фазы). Такая подстройка
необходима   из-за   неизбежного  разброса
значений  скорости  вращения  дисководов и
частоты тактового генератора контроллеров.
    Началом   (и  концом)  каждой  дорожки
является   точка   пересечения  окружности
дорожки с радиусом, проходящим через центр
индексного  отверстия  дискеты.  В  начале
дорожки  записана последовательность из 80
байтов #4E, называемая GAP4A. (В процедуре
форматирования   из   прошивки  TR-DOS  их
определено   10,   из-за   чего  тормозной
IBM-овский    контроллер    не    успевает
"схватить"   начало  первого  (первого  на
треке)  сектора). Далее находится адресный
маркер  дорожки  (IAM),  который необходим
для  нормальной  работы  контроллера.  IAM
содержит    маркерные    байты    #C2    и
идентификатор      #FC.     Затем     идет
последовательность   из   50  байтов  #4E,
называемая    GAP1    и    заголовок   или
идентификатор    (ID)   первого   сектора,
состоящий  из  адресного маркера заголовка
(IDAM), 4-х байтов (TRACK, SID, NUM, LEN),
2-х   байтов  'CRC'  (контрольная  сумма).
Маркерные   байты   IDAM  имеют  код  #A1,
идентификатор  #FE.  За заголовком каждого
сектора следует последовательность из 22-х
байтов   #4E,   которая   называется  GAP2
(внутрисекторный     промежуток),    затем
адресный  маркер данных сектора (DATA AM),
информационные  байты (содержимое сектора)
и  два  байта  'CRC'.  DATA  AM состоит из
маркерных  байтов #A1 и идентификатора #FB
или   #F8.  #FB  соответствует  нормальным
данным,  #F8  -  так  называемым удаленным
данным,   причем  такое  разделение  имеет
чисто  условный характер. Удаленные данные
записываются  и читаются точно так же, как
и  нормальные,  просто используются разные
команды  контроллера.  За  концом  первого
сектора    следуют   байты   межсекторного
промежутка,  имеющие код #4E. Межсекторный
промежуток,   имеющий   название  GAP3,  в
отличие    от    выше   описанных,   имеет
переменную   длину.  Промежуток  от  конца
последнего   сектора   до   конца  дорожки
называется    GAP4B.    Этот   промежуток,
заполнен  байтами  #4E,  имеет  переменную
длину   и  фактически  представляет  собой
незаполненый остаток дорожки.
 
Информацию предоставил:
 Tom_Hial/Ascendancy Cr.L. г.Гродно