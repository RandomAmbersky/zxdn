Из журнала ZX Format #6,
Санкт-Петербург, 30.07.1997



          Макро модем v2.20.

(C) MAS
_________________________________________

           Модем - как много в этом слове
           для сердца "юзера" слилось.
           Как много в нём переплелось...

      (А.С.Пушкин. Из неопубликованного.)


   Для  начала - немного истории. В своей
жизни каждый попадал в какую-нибудь исто-
рию  и мы, Omega Group не исключение. Так
вот, когда-то, давным-давно, существовала
программа под названием модем 3.5 (скорее
всго  именно она способствовала вымиранию
динозавров  и  чуть  было не погубила ви-
комм).  Работать с ней было очень тяжело,
но она экономила нам массу времени. Суди-
те  сами  - если фаил влезал в двадцать с
чем-то килобайт, то не приходилось за ним
ехать  через  весь город. Попользовавшись
этой  программой  пару месяцев, мы вконец
обленились  и решили "немного доработать"
её,  чтобы не ездить друг к другу даже за
самыми длинными файлами. Результатом этой
"небольшой  доработки"  и стал "Макро Мо-
дем"
             _____

   Макро-Модем, или, как мы его называем,
ММД  -  самая скучная программа. При заг-
рузке  не появляется ползучая строка, пе-
редающая приветы Попу, его собаке и куску
мяса,  выйти из которой можно, только до-
читав её до конца. В принципе, сразу пос-
ле  загрузки можно хватать телефон и зво-
нить  своему приятелю. В таком случае Вас
ждёт несколько месяцев, зполненых малень-
кими открытиями. Для тех же, кто не любит
метод  проб и ошибок, и написана эта ста-
тейка...

   Для  начала  разберёмся - зачем вообще
нужен ММД. Как и любая терминальная прог-
рамма  - для передачи информации по теле-
фонной линии (если, конечно, есть модем).
Что  это будет за информация, решать вам,
так как программе это безразлично. По са-
мым  скромным  прикидкам,  Вы сможете об-
щаться  со  своими знакомыми не просто по
телефону, а печатая свои реплики на мони-
торе.  Кстати,  весьма прикольное знятие.
Кроме  того,  у  Вас появится возможность
обмениваться любыми программами с теми же
знакомыми  и,  наконец,  только с помощью
Макро  Модема  Вы  сможете подключиться к
сети SpbZxNet.

   Перед тем, как перейти к описанию тон-
костей  в работе ММД, приводим требования
к  машине.  Вдруг  на  вашей  "тачке"  не
пойдёт,  а  Вы уже всё прочитали. Абыдно,
да?

 - Требуется минимум 128К и дисковод.

 - Должен иметься драйвер модема.

  Все остальные ограничения накладывает
             драйвер модема.

     Если Вы используете драйвер для
              Vicomm'a , то:

 - Должен иметься "девайс" под  названием
   викомм.  (схема этого устройства неод-
   нократно  публиковалась и собрать её в
   домашних  условиях  сможет  любой, кто
   отличает  резистор  от конденсатора, а
   транзистор от трасформатора).

 - Скорость вашей машины не должна сильно
   отличаться  от  нормальной.  В приципе
   под  это  условие  подходят  почти все
   нормально собранные компьютеры. Если к
   вашей  машине  подобное определение не
   подходит,  то  ММД будет работать и на
   ней, но качество связи ухудшится. Вся-
   ческие  ТОРМОЗА  и ТУРБО-РЕЖИМЫ должны
   быть выключены!


     Если вы используете драйвер под
             XTR-модем , то:

 - Естественно, должен быть "девайс".

 - Тактовая частота компютера должна быть
   в пределах 3.5-7.0 Мгц.


   На  этом минимальные требования к ком-
пьютеру  исчерпываются,  но  максимальное
удовольствие от работы вы получите, имея:

 - Scorpion ZS-256
 - Музыкальный сопроцесор AY 8910(12)
 - Кемпстон мышку

   Теперь аппаратные требования полностью
исчерпаны и можно перейти к описаню рабо-
ты с программой.
             _____

  При   запуске   ТЕРМИНАЛКИ  тестируется
компьютер.  Результаты  теста  Вы  можете
увидеть при вызове опции "ПРОСМОТР log'a"
или  при  запуске  программы (если будете
удерживать ПРОБЕЛ)...

  На  экран  будут  выводиться результаты
всех действий:

 - размер оперативной памяти и наличие
     резидента (только для Scorpion'а)
 - наличие и статус кемпстон мыши
 - наличие муз. сопроцессора
 - наличие програмно-переключаемого
   турбо-режима.
   Программа определяет Турбо-режимы
   у Scorpion ZS-256, KAY-256, Turbo 2+.

       Также будет произведен поиск
       и загрузка некоторых файлов:

 - файлы макросов и телефонной книжки

 - внешний драйвер работы с линией.
  При его отсутствии программа будет жут-
ко ругаться, но всё-таки запуститься... в
демо-режиме...
             _____

   Сразу после загрузки ММД готов к рабо-
те.  На  экране можно разглядеть примерно
следующее:

+=============================+
| ОКНО 1 "кнопки" и информация|
+=========+========+==========+
|  ОКНО 2 | ОКНО 3 |  ОКНО 4  |
|         |        |          |
| рабочий | инфор- | принятый |
| каталог | мация  | каталог  |
+=========+========+==========+
|  ОКНО 5  подсказка клавиш   |
+=============================+
|          ОКНО 6             |
|         терминал            |
+=============================+


   На  самом  деле  всё  будет  несколько
крупнее ;)

Окно 1 - выведены  "кнопки" для  работы с
мышкой и выведена некоторая системная ин-
формация
Окно 2 - каталог Вашего диска.
Окно 3 - информация о текущем каталоге.
Окно 4 - каталог вашего абонента. Появит-
ся только после того, как вы его примете.
Окно 5 - подсказка функциональных клавиш.
                    (может отсутствовать)
Окно 6 - окно терминала.

  На самом верху (в окне 1) будет выведе-
на такая строка:
-----------------------------------------
10640  рус  Dos Line View Mac Phone Off_l
-----------------------------------------

   Слева  указан  размер свободной памяти
для log'а, а также указано, идет запись в
log  или  нет  (наличие/отсутствие  буквы
"L")

   LOG - это "протокол" работы с модемом.
В том смысле, что в нём хранится всё, что
попало  в окно терминала. Будь то "разго-
вор"  с  абонентом,  сообщение об удачном
приёме/передаче файла, сообщения об ошиб-
ках и даже имена запускавшихся файлов.

   Правее     указан    регистр    клавиш
(LAT/РУС),  и  указано, какие буквы будут
выводиться (большие/маленькие)

   С  правого  края  указан  статус линии
"Off_l"  (трубка  положена).  Если трубка
"снята",  то  выводится  текущая скорость
передачи информации.

   Посередине находятся "пиктограммы" для
работы с мышкой. (См. Работа с мышой)

   Чуть  ниже информационной строки нахо-
дятся каталоги: рабочий и принятый.
   Над  каталогами выводятся имена диско-
вода и диска (A:Diskname), причем в ката-
логе  ПРИНЯТЫХ файлов перед именем диско-
вода стоит буква "X". (Почему "X" - я сам
не знаю...)


     В ИНФОРМАЦИОННОМ ОКНЕ ВЫВОДЯТСЯ:

Files: Число файлов в каталоге
Del.F: Число стертых файлов
 Free: Число свободных секторов
 MARK: Число отмеченых файлов
 SIZE: Размер отмеченых файлов в секторах
SetUp: Какая из двух установок систмы
       сейчас активна

    ОКНО "ПОДСКАЗКА" кратко напоминает,
   какие клавиши для чего используются:
-----------------------------------------
CS+Ent>DISK   SS+Ent>LINE   Extend>MACROS
SS+I>Unsel  Tr.V.>PANELS  Inv.V.>Cat/mark
SS+Q>Size SS+W>Log SS+E>Phone SS+Spc>View
-----------------------------------------

         РАБОТА_С_KEMPSTON-MOUSE

   Если  Ваш компьютер оснащен мышкой, то
работать с программой будет намного удоб-
нее.  Вы  можете  с  помощью мышки делать
почти  всё. (Ну разве что не можете наби-
рать символы в терминале ;-)

   После запуска программы первая нажатая
кнопка  мыши будет считаться "ОГНЕМ", со-
ответственно, другая будет "ОТМЕНОЙ".

   Если  Ваша  мышка трехкнопочная, то не
забывайте,  что  в программе используются
все  три кнопки. Если же Ваша мышка имеет
только две кнопки, то нажмите одновремен-
но обе - и программа поймёт это как нажа-
тие средней кнопки.

   Для  вызова какого-нибудь меню укажите
мышкой на соответствующее слово в верхней
строке и нажмите "ОГОНЬ".

   Использование различных клавиш мыши:

   При  указании  на регистр клавиатуры с
помощью   клавиши  "ОГОНЬ"  производиться
смена  LAT/РУС, а клавишей "ОТМЕНА" выбор
большие/маленькие буквы.

          В правом верхнем углу:

ОГОНЬ  : снять трубку;
ОТМЕНА : положить трубку;
СРЕДНЯЯ: кнопка - смена скорости.

   Если курсор мыши указывает на каталог,
то клавиши выполняют следующие действия:

ОГОНЬ  : перенести курсор и отметить файл
ОТМЕНА : перенести курсор на данный файл
СРЕДНЯЯ: отметить все файлы/снять отметки

   Если  курсор  мыши  находится на самой
верхней или самой нижней строке каталога,
то "ОГОНЬ" вызовет перелистывание катало-
га вверх/вниз на страницу; "ОТМЕНА" - вы-
бор  режима:  все/отмеченые файлы, "СРЕД-
НЯЯ" - отметить все файлы/снять отметки.

                  МЕНЮ

   При  открытии любого меню слева от оп-
ции будут стоять цифры от одного до девя-
ти. Это "горячие" клавиши. Вы можете выб-
рать  пункт  КУРСОРОМ,а затем нажать <En-
ter>,  или сразу нажать на клавишу с этой
цифрой.
   Для  закрытия  окна  нажмите  <Space>,
<Break>,  а также, за исключением некото-
рых  окон,  можно  закрыть  окно клавишей
<Edit>.

         РАБОТА_В_ОСНОВНОМ_РЕЖИМЕ

   После  загрузки программа находиться в
основном режиме.

   Нажатие  на  любую  алфавитно-цифровую
клавишу  приведёт к тому, что эта клавиша
будет  выведена на экран в окне терминала
и будет передана в телефонную линию Ваше-
му абоненту.

   Остальные функциональные клавиши ниче-
го  передавать  не  будут, но вызовут ка-
кое-то действие:

  Клавишей <True Video> можно выбрать:
          СВОЙ/ПРИНЯТЫЙ каталог.

   <Inv. Video> - переключение каталога
   в режим ВСЕ/ТОЛЬКО ОТМЕЧЕНЫЕ файлы.

 Перемещение по каталогу: КЛАВИШИ КУРСОРА
    ПОСТАВИТЬ/СНЯТЬ отметку: <GRAPHICS>

 Одновременное нажатие <Symbol Shift>+<I>
сделает  такую вещь: если в текущем ката-
логе  имеются  отмеченые файлы,то они ис-
чезнут.  А  если ни один файл не отмечен,
то отметятся ВСЕ.

  СОЧЕТАНИЕ КЛАВИШ <Symbol Shift>+<Q>
          изменяет размер окон:

   Если  каталоги  выведены  на экран, то
они исчезнут и размер окна терминала уве-
личится.  Если каталогов нет, то они поя-
вятся.
   Чтобы  изменить  размер окон с помощью
мыши,  опустите  ее  в самый низ экрана и
нажмите ОГОНЬ

<SS>+<W> - тригерное включение/выключение
разрешения записи информации в log.

<SS>+<E> - окно  работы с  записной книж-
кой.

<CS>+<Enter> - работа с диском.

<SS>+<Enter> - обмен информацией.

<Extend Mode> - работа с макросами

   Макросы  - это такие небольшие тексти-
ки,  которые можно передать нажатием двух
клавиш.

   Единственной не описаной в "подсказке"
клавишей  осталась  <BREAK>  (не  хватило
места...)

   Нажав  на  неё, Вы заходите в SetUp, в
котором  можете  настроить  программу  по
своему вкусу. SetUp затем можно сохранить
на диске.
   Чтобы  войти  в  SetUp с помощью мыши,
опустите  её в самый низ экрана и нажмите
среднюю клавишу или клавишу "ОТМЕНА"

   Caps_Shift_+_Enter_-_работа_с_диском

1) СМЕНИТЬ ДИСК - ...

2) ЗАПУСК ФАЙЛА - если курсор на ЛЕВОЙ
     панели  указывает  на BASIC-файл, то
     он  запустится.  Вот тут-то и приго-
     дится резидент SCORPION'а

3) ПЕРЕИМЕНОВАТЬ ФАЙЛ - ... ну что здесь
     сказать? Можно изменить как само имя
     файла,  так  и расширение... Клавиши
     влево/вправо - перемещение по файлу,
     клавиша вверх - удалить старое имя.

4) УДАЛИТЬ ФАЙЛЫ - удаление отмеченых
     файлов.

5) СОХРАНИТЬ LOG - сохранение всего,что
     было набрано в терминале. Имя файла
     задается через "Set Up"

6) ОЧИСТИТЬ LOG - странная функция...

        SS+Space_-_Работа_с_линией

 1) СКОРОСТЬ: ? Значения и количество
     скоростей зависят от драйвера. Всего
     может быть восемь скоростей.

 2) ЗАПРОСОВ: ??? - число попыток
     приема/передачи

 3) ПРИЕМ/ПЕРЕДАЧА

 4) ТИП: HOBETTA / TEXT - передавать файл
     типом  Hobяtta  -  сам файл вместе с
     заголовком,  или  же как ТЕКСТОВЫЙ -
     только само содержимое файла.

 5) ФАЙЛЫ - принять / передать отмеченые
     файл(ы) (в зависимости от пункта {3}

 6) КАТАЛОГ - передать свой каталог/при-
     нять  каталог  абонента (XA...XD) (в
     зависимости от пункта {3}

 7) ДИСК - принять/передать диск с любого
     по  любой  трек  (в  зависимости  от
     пункта {3}

 8) АВТООБМЕН - передать список отмеченых
     Вами  файлов  на  принятом  каталоге
     и перейти в режим "ПРИЕМ ФАЙЛОВ"

   С  пунктом за номером {8} придётся ра-
зобраться  поподробнее.  Предположим - Вы
позвонили своему приятелю и ужасно хотите
получить  десять  картинок, игрушку "Jum-
ping  Jack" и последний номер ZXNews, a у
приятеля  времени  - минут 5 только. Ему,
например,   обед  готовить  надо.  Ничего
страшного!   Пускай  себе  готовит  обед,
только  сначала  запустит ММД и вставит в
дисковод  A:  диск с играми, а в дисковод
B:  - картинки и газету (на диске конечно
;). Больше от него ничего и не требуется.
Выбрав  в пункте {3} - ПРИЕМ, тыкаем кно-
почку  {6}  и  получаем каталог его диска
А:.  Тыкаем кнопочку [TRUE VIDEO] и отме-
чаем  нужные файлы. Теперь снова входим в
SS+Enter  и тыкаем кнопочку {8}. Ждём не-
которое  время, пока файлы примутся/запи-
шутся и повторяем те же действия с диском
B:. Тыкаем ext.mode, нолик. Пока приятель
бежит  с кухни - узнать, что там "бумкну-
ло",  печатаем - спасибо, мол, можешь от-
рубаться. Вот и всё!

   Если  вам надо только передать что-ни-
будь, то всё ещё проще. Отмечаете в своём
каталоге файлы. SS+Enter в пункте {3} вы-
бираем "ПЕРЕДАЧА" и тыкаем кнопочку "ФАЙ-
ЛЫ" - всё!

     Extend_Mode_-_Работа_с_макросами

<A>...<Z> - передача     соответствующего
            макроса.

<Caps Shift>+<A>...<Z> - РЕДАКТОР
                         МАКРОСОВ

        Нажатие <EXTEND MODE> +

 - <0> приведёт к "дзинь" у абонента.

 - <1> очистка экрана абонента; зачем та-
   кое надо - сам не знаю... :)

 - <2> будет передан код "Escape"
                                (27, #1B)

 - <3> можно узнать версию терминалки у
       вашего  абонента.  Можно использо-
       вать для проверки качества связи.

 - <4> в линию будет несколько раз послан
       код 24 (CONTROL+X). Этот код нужно
       "пропищать"  для того, чтобы прер-
       вать прием/передачу.

 - <5> будет послан запрос окончания свя-
       зи. По  этому запросу BBSка "пове-
       сит" трубку.

 - <7> отключить модем от линии
       (если  драйвер позволяет управлять
       линией)

 - <8>  и  <9>  подключить  модем к линии
(если драйвер позволяет управлять линией)

   Если в установках флаг "Установка ско-
рости"  выключен,  то  ничего  больше  не
произойдет.  Если включен, то модем будет
пытаться выбрать наилучшую скорость обме-
на  (опять  же,  если драйвер позволяет).
Причем  по  клавише  <8> модем будет "пи-
щать" в линию, а затем "слушать" её, а по
<9>  вначале  "слушать".  Т.е.  на  одном
компьютере делаем <8>, а на другом - <9>,
и они выбирают наилучшую скорость.
   Но это произойдёт только в том случае,
если в драйвере реализован автовыбор ско-
рости.

            РЕДАКТОР МАКРОСОВ

           1 МАКРОС: ?
           2 следующий
           3 предыдущий

   С  помощью  клавиш  <2>, <3> вы можете
выбрать интересующий вас макрос.
   Клавиша  <1> - редактирование макроса.
Выход из редактирования - "Break". Макси-
мальная длина макроса 64 байта.
   В  тело макроса можно включать некото-
рые  спецсимволы "Bell", "Cls", "Escape",
"Test"  и  т.д., для чего во время набора
нажмите <Ext.Mode> и соответствующую циф-
ру.

   Как было скзано, всего макросов 26, но
это  неправда!  Имеется  ещё  2 макроса с
именами "Ring" и "Call".
   Макрос  "Ring" будет передан после ав-
томатического  подключения модема к линии
при  обнаружении сигнала вызова. А макрос
"Call"  будет  передан  после  того,  как
программа  дозвонится до абонента и уста-
новит с ним связь.

        SS+Space_-_просмотр_файлов

           1 ФАЙЛ: код
           2 ФАЙЛ: текст
           3 ФАЙЛ: экран
           4 Посмотр log'а

   Ну,  по  кнопочке  "4" Вы перейдете на
просмотр Log'a в режиме "код".

   А   по  "1","2","3"  загружается  либо
файл, отмеченый курсором, либо первый от-
меченый, после чего отметка с него снима-
ется.

   После  загрузки программа переходит на
просмотр файла.

         ПРОСМОТР ЭКРАННЫХ ФАЙЛОВ

   Первые  6912 байт файла будут выведены
на экран. Рабочие клавиши при просмотре:

          2 - все цвета/моно1/моно2
          3 - смена цвета бордюра
SPACE/BREAK - выход
  Edit/Caps - загрузить следующий
              отмеченый файл

             ПРОСМОТР ТЕКСТОВ

           Управляющие клавиши:

        "1" - ЦВЕТ ЧЕРНИЛ
        "2" - ЦВЕТ БУМАГИ
        "3" - ЦВЕТ БОРДЮРА
SPACE/BREAK - выход
  Edit/Caps - загрузить следующий
              отмеченый файл

      НА ЭКРАН:

     ВПЕРЕД - Enter,True Video
      НАЗАД - Inv. Video

      НА СТРОКУ :

     ВПЕРЕД - Стрелка вниз, "Q"
      НАЗАД - Стрелка вверх, "A"

    Также действует курсорные клавиши
             и кнопки мыши:
    "ОГОНЬ" - вперед на страницу,
   "ОТМЕНА" - назад на страницу,
  "СРЕДНЯЯ" - выход


   С  помощью кнопки "4" Вы можете перек-
лючать  режим  "код/текст". Режим "текст"
индицируется   значком  "<->"  в  верхней
строке.

                 Разница:
  "Код": если имеются строки, длинее 42-х
символов,  то  они  будут  "порезаны"  на
строки по 42 символа.

  Режим   "текст":  на  экран  выводиться
только  часть длинной строки и можно кла-
вишами "стрелка влево/вправо" перемещать-
ся влево/вправо по строкам.

          SS+E_Телефонная_книжка

   Откроется окошко во весь экран, сверху
будут  "кнопки"  для работы мышой, а ниже
сама записная книжка:

+-----+------------+--------------------+
| 0 * | 123-45-67  | Сосед Вася         |
| 1 * | 765-43-21  | Вася-сосед         |
| 2 * | 008        | любимая BBS        |
| 3   | 999-99-99  | сам не знаю кто это|
| 4 * | 888-88-88  |                    |
| ... | ...        | ...                |
| 20  |            |                    |
+-----+----- Ext. Mode - help ----------+


   Т.е.  книжка  расчитана на запоминание
21-го номера...

               Значит, так:

   Если нажать <Extend Mode>, то появится
краткая  подсказка  клавиш,  выполненая в
стиле  подсказки  макросов  или  основной
подсказки.

   Если подвести курсор к номеру и нажать
<Cs+Enter>, то Вы сможете отредактировать
строку  с номером. Причём с помощью стре-
лок ВЛЕВО/ВПРАВО вы можете перейти из ок-
на с номером к окну коментария и обратно.

   Если набрать номер строки или подвести
курсор  к  номеру  и  нажмёте <Enter>, то
программа  будет  дозваниваться  до этого
номера.

   Нажав  <Inv.Video>, Вы можете ввести с
клавиатуры любой номер, и программа будет
дозваниваться до этого номера.

   <Tr.Video> - обзвонка номеров, помече-
ных  двумя "галками". Вначале позвоним по
номеру  в  строке "00", если связаться не
сможем  (ну, там занято или не отвечают),
то набираем номер в стрке "02" и т.д. Как
только дозвонимся до какого-то номера, то
"левая  галка" будет убрана - показывает,
что  номер помечен, но до него уже дозво-
нились.

   С  помощью  "Delete"  можно  выставить
"левые галки" там, где есть "правые".

          Небольшое замечание:

   Если  Вы попросите программу позвонить
в  то  время, когда модем подключен к ли-
нии, то дозвон будет невозможен.
   Ну,  например,  Вы, "чатясь" с кем-ни-
будь, нечаяно вошли в книжку и что-то на-
жали.  Если бы не было контроля, то модем
просто повесил бы трубку и начал дозвани-
ваться... А зачем Вам _это_ надо?

   А  вот  если  Вы  действительно хотите
позвонить,  то вначале отключите модем от
линии:  либо  через  макросы,  либо нажав
<SS+Q> в записной книжке, либо мышкой...


          Как происходит дозвон:

   Если  во  время  набора  номера нажать
<ПРОБЕЛ>, то набор будет прерван.

   Если  во время ожидания ответа понажи-
мать на клавиши, то получим результат:

   <Enter> или "ОГОНЬ" на мыши - не ждать
больше  и дозваниваться до следующего но-
мера.

   <Space> или "ОТМЕНА" на мыши - прекра-
тить дозвон и повесить трубку.

   <Graphics>  или  "СРЕДНЯЯ"  на  мыши -
считать, что дозвонились, т.е. прекратить
дозвон, убрать у номера "левую галку".

  Если ничего на нажимать, то программа
       будет контролировать линию:

 - поймав  короткие  гудки,  переходит на
   набор следующего номера;
 - поймав какой-нибудь блок с  линии, ра-
   достно "бумкает" и оканчивает дозвон
 - если некоторе время ничего не происхо-
   дит, то считает, что так и надо, и пе-
   реходит на набор следующего номера.

        <Break>_-_установки_(Set_Up)


   Вы можете иметь одновременно два наст-
роенных  SetUp'а.  Один из них, например,
для  общения  с Ис-Досной терминалкой или
со счастливым обладателем программы MODEM
3.5,  а  другой - для работы в расширеном
режиме,  с  поддержкой  всех возможностей
программы.

   При  выходе  в  SetUp появится окно во
весь экран, на самом верху которого будет
выведена информация о загруженом драйвере
модема.

            Ниже будет окно:

           1    SetUp 1
           2     МОДЕМ
           3     ФЛАГИ
           4    СЕРВИС
           5 ВНЕШНИЙ SetUp
           6 СОХРАНИТЬ SetUp


   Кнопочкой  "1"  вы  можете переключать
установки.  Остальые опции откроют менюш-
ки.

               ОКНО "МОДЕМ"

 1)  ЭХО  ОТ КЛАВИШ on/off - выводить или
нет  на  экран  набираемые  Вами символы.
Функция нужна для работы с BBS, поскольку
передаваемые  вами символы BBS возвращает
обратно и (при ЭХО on) вместо одного сим-
вола  на экране будет два. Также при вык-
люченом эхе прием информации будет проис-
ходить  в буфер: если программа приняла с
линии какой-то блок, то он запоминается в
буфере  и производится дайльнейшее ожида-
ние.  Если в течение 1.5-2 сек придет но-
вый  блок,  то он будет добавлен в буфер.
Если  нет - содержимое буфера будет выве-
дено  на  экран. При наличии информации в
буфере надпись "L10640" будет мигать.

 2)  КОМАНДЫ on/off - передавать/не пере-
давать  код  выполняемой  команды (прием/
передача  файла/каталога/диска)  в  линию
(чтобы второй компьютер её отследил).

 3)  ДЛИНА  БЛОКА 128/256 - файлы переда-
вать  блоками  по 128 или 256 байт (128 =
Vicomm). При работе с длиной 256 байт об-
мен происходит немного быстрее. Принимаю-
щий компьютер сам определит длину блока.

 4)  КОНТРОЛЬ ДЛИНЫ on/off - нужно ли за-
поминать, какая длина блока была при при-
еме?  Если  on,  то  значение предыдущего
пункта  изменится в соответствии с приня-
той длиной блока.

 5) КОНТРОЛЬ СКОРОСТИ on/off - изменять /
не  изменять автоматически скорость пере-
дачи,  если корреспондент передаёт с дру-
гой  скоростью,  нежели стоит в Вашем Se-
tUp'е.  Лучше  всего  этот  флажок всегда
выставлять  в "off". Даже если у вас выс-
тавлена скорость 2400, а у вашего абонен-
та  600,  программа  сама  сообразит, как
выбраться из этой ситуации.

 6)  УСТАНОВКА СКОРОСТИ on/off - нужно ли
после  автоснятия  трубки  при звонке или
после автодозвона попытаться выбрать наи-
лучшую скорость обмена. (разумеется, если
драйвер поддерживает этот режим).

 7) КОНТРОЛЬ ЛИНИИ on/off - нужно ли ана-
лизировать короткие гудки и, при нахожде-
нии их, повесить трубку.

 8)  ЗВОНКОВ ??? - через какое количество
вызовов модем должен снять трубку. Значе-
ние 000 - не реагировать на вызов.

               ОКНО "ФЛАГИ"

 1)  DOS:  fast/norm  -  как обращаться к
диску:  с помощью турбо-лоадера или обыч-
ным  медленым способом. Второй способ ну-
жен для работы с винчестером.

 2) КОНТР.ДИСКА on/off - нужно ли контро-
лировать  наличие диска в дисководе? Если
on,  то  при отсутствии диска в дисководе
программа переходит в режим "чтение ката-
лога".

 3)  КОНТР.КАТ. on / off - нужно ли перед
приемом  _каждого_  файла или перед любой
операцией  с диском, могущей изменить ка-
талог, перечитывать диск.
   Этот флажок полезен тем "склеротикам",
которые выключили КОНТРОЛЬ ДИСКА, сменили
диск,  а  каталог  не  перечитали. В этом
случае  во  время  приёма  файлов КАТАЛОГ
диска оказался бы уничтоженым.

   Лучше,  если оба контроля выставлены в
"on". Если Вам удастся каким-нибудь обра-
зом обмануть КОНТРОЛЬ ДИСКА (если ооочень
быстро  выдёргивать  диск и так же быстро
запихивать новый), то уж контроль катало-
га можно обмануть только специально - по-
меняв  диск после того, как начался приём
файла.

 4) АВТОСОХР.LOG on/off - нужно ли сохра-
нять  log  при  переполнении  или  просто
очистить его.

 5) ЗВУК on/off - странная функция...

 6) ОТЗВУЧКА on/off - должна ли программа
немножко "пошуметь" в конце обмена. В за-
висимости  от  того, как прошел обмен ин-
формацией, будут звучать:

  - музыка счастливого окончания обмена
  - жалобная песенка об обломе при приёме

 7)  К.  ЗАДЕРЖКА  -  количество  вызовов
программы сканирования клавиатуры до пов-
тора  при  длительном нажатии. Значение 0
запрещает автоповтор при длительном нажа-
тии.

 8)  К. ПОВТОР - число, равное количеству
опросов клавиатуры между автоповторами.

   Если у Вас IBM клавиатура не очень ра-
ботает с ММД, поэкспериментируйте с пунк-
тами 7 и 8.

              ОКНО "СЕРВИС"

 1)  KEMPSTON MOUSE on/off - мышь активи-
зирована  или нет. Если вам мешает курсор
мыши, или автоопределение не срабатывает,
то выключите эту опцию.

 2)  РЕЗИДЕНТ on/off - работает только на
SCORPION  ZS  256. Терминалка при запуске
любой  (ну,  почти любой...) программы (и
такое  можно)  сохраняет  себя  в Scorpi-
on'овских  страницах.  Нажав  в программе
Magic или Reset, Вы вернётесь в "MacroMo-
dem". На неСкорпионе флажок сам выставит-
ся в off.

 3)  РАЗБИВКА  ПО  64/255sec - при приеме
текстовых  файлов  программа будет разби-
вать  их  на  блоки  по  16к(64  sec) или
63.75к(255 sec). Блоки по 16К можно обра-
батывать любым текстовым редактором.

 4) ВЫВОД MAIN HELP on/off - нужно ли вы-
водить подсказку клавиш. Если Вы запомни-
ли,  какая  клавиша  для  чего служит, то
выключите  эту  опцию,  и  окно терминала
увеличится на три строки.

 5) СКОРОСТЬ В ТЕРМИНАЛЕ - ... ну эта оп-
ция   была   введена  "по  многочисленным
просьбам  трудящихся". ;) Вот в чём проб-
лема:  работать в терминале удобнее всего
на  скорости  "600"  - вряд ли Вы сможете
нажимать более 75-ти клавиш в секунду ;),
а качество передачи - наивысшее. Ну а пе-
редавать  файлы  лучше  всего на "2400" -
всяко быстрее будет...
   Но постоянно переключать скорость было
весьма  утомительно... И посему была вве-
дена  эта  опцию: всё, что Вы набираете в
терминальном  режме,  передаётся  на этой
скорости, а приём/передача осуществляется
на  скорости,  указаной  в меню "РАБОТА С
ЛИНИЕЙ".
   Если  же Вам разные скорости не нужны,
то выберите "СКОРОСТЬ -----". Эта пакость
означает:  в  терминале использовать ско-
рость,  установленую в меню "РАБОТА С ЛИ-
НИЕЙ".

 6)  Скорость при звонке - . При обна-
ружении вызова скорость передачи в терми-
нале  установится в указаное здесь значе-
ние.  Если  скорость  терминала выключена
("-----"),  то установиться основная ско-
рость. Если же данная скорость выключена,
т.е.  "-----", то ни одна скорость не из-
мениться.

        ОКНО "СОХРАНЕНИЕ SetUp'А"

          1 Сохранить SetUp
          2 Записать в файл
          3 Считать из файла

   Пункт  1 сохранит все установки в теле
программы.
   2-й  пункт запишет установки в отдель-
ный  файл,  имя которого Вы можете задать
во ВНЕШНЕМ SetUp'е.
   С  помощью опции 3 можно считать уста-
новки,  записаные  в  файл.  Будет считан
файл,  на  который указывает курсор, либо
первый  отмеченый  файл, причём отметка с
него  снимется.  Если в указаном файл нет
установок  модема,  то будет выдано соот-
ветствующее  сообщение, и Вы сможете поп-
робовать   считать   следующий  отмеченый
файл.

              ВНЕШНИЙ_SetUp


     При  вызове этой опции с диска будет
подгружен   файл,  который  позволит  ещё
что-нибудь настроить.

                Внимание!
    По техническим причинам во внешнем
       SetUp'е мышь не реализована!

             Появиться окно:

           1 Цвета системы
           2 Имена файлов
           3 Раскладка клавиатуры
           4 Работа с линией

              ЦВЕТА СИСТЕМЫ

   На  экране появиться список изменяемых
цветов  (их  всего 34 штуки ;), клавишами
КУРСОРА  Вы  можете  выбрать интересующий
Вас цвет.
   Чуть  выше окна со списком будет нахо-
диться  окошечко с цифрами. Данное окошко
будет  окрашено  в  текущий цвет, а цифры
будут означать следующее:
 Яркость  (0/1),  Цвет фона (0...7), Цвет
символа (0...7). Для изменения цвета наж-
миите <Enter> и введите цвет.

               ИМЕНА ФАЙЛОВ

       Вы сможете задать имена всех
            системных файлов:

           1 МАКРОСЫ
           2 ТЕЛЕФОНЫ
           3 ДРАЙВЕР
           4 ВНЕШН. SetUp
           5 ТЕКСТ
           6 LOG
           7 Сохр. SetUp

  {1},  {2} и {3} - именно эти файлы ищет
программа при запуске. Ну а что в них на-
ходится - догадайтесь сами! ;)

 {4} -  именно этот файл  ищет программа,
когда вы вызываете "Внешний SetUp"

 {5} -   если  будет  принят файл с типом
"Text",  т.е. без заголовка, то ему будет
присвоено это имя.

 {6} -  имя файла для сохранения Log'a.

 {7} -  если вы попросите сохранить уста-
новки  в  файл,  то создастся файл с этим
именем,  даже  если  файл  с таким именем
имеется.

   Имена {5} и {6} имеют одну особеность:
после  создания  файла  с этим именем два
последних  символа  будут  изменены: если
они  были  не  цифрами - станут "00" если
был цифрами - увеличаться на один.

            РАСКЛАДКА КЛАВИАТУРЫ

   С  помощью этой опции вы можете задать
раскладку  русской  клавиатуры. Поскольку
их  существует  порядочное количество, то
здесь  используется  весьма  оригинальное
решение: Вы сами выбираете, на какой кла-
више находится какая русская буква!

   Появится  окно,  в котором будут пере-
числены  все русские буквы, и через двое-
точие соответствующая им клавиша. Для из-
менения  клавиши укажите на неё курсором,
нажмите  <Enter> и введите новую клавишу.
Можно  использовать  любые клавиши, кроме
Caps+цифра,  <Enter>, <Пробел>, <SS>+<Q>,
<SS>+<W>, <SS>+<E>, <SS>+<I>...

             РАБОТА С ЛИНИЕЙ

   Если  используемый драйвер модема поз-
воляет набирать номер, то с помощью опции
4 можно кое-что настроить:

  1  ПОПЫТОК  ДОЗВОНА - Сколько раз прог-
рамма  будет пытаться дозвониться до або-
нента.

  2  СПОСОБ НАБОРА - импульсный/тональный
если  драйвер  не  поддерживает тональный
набор, то его выбрать не удасться

  3 Период  набора номера - чем меньше (в
разумных пределах!) тем быстрее набирает-
ся  номер.  Стандартно  100  мс,  на всех
станциях  допустимо 80 мс, на электронных
можно и 40 мс.

  4  Межцифровая  пауза  - задержка между
набором  цифры.  Чем меньше - тем быстрее
набирается номер. В разумных пределах ко-
нечно  же! ;) Стандартно - 600 мс, допус-
тимо 400 мс.
                Внимание!
   Здесь  небольшая  тонкость:  при вводе
паузы   вы   вводите   число  в  пределах
0...255,  а  затем оно домножается на 10.
Т.е.  для  того  чтобы  ввести 600 ms Вам
нужно ввести только 60.

   Если  ваш драйвер может определять но-
мер  звонящего Вам абонента, то следующие
опции очень пригодятся!

  5 ЧИСЛО ЗАПРОСОВ - Значение от 0 до 99.
         0 - номер определяться не будет.
      1..3 - разумно при внутригородском
             звонке.
      4..9 - разумно при возможности
             междугороднего звонка.
    10..99 - Хм... разумно при борьбе
             с анти-АОНом.

  6 КОЛИЧЕСТВО ЦИФР  - Сколько цифр в но-
        мере надо определять: 5...7

  7 ПАУЗА ДО ЗАПРОСА - Задержка в ms меж-
        ду  снятием  трубки  и  передачей
        первого запроса.Нормально 200 мс.

  8 ЧУВСТВ. К ОТВЕТУ  - Параметр, опреде-
        ляющий  чувствительность  АОНа к
        ответу  станции.  Нормально  12,
        при  шумной линии или частом не-
        определении увеличить.

  9 ЧУВСТВ. К ЛИНИИ - Параметр,определяю-
        щий  степень чувствительности АО-
        На  к  сигналу в линии. Нормально
        6.

             _____


           Несколько_замечаний


            КОНТРОЛЬ СКОРОСТИ

   Поскольку имеется ДВЕ скорости переда-
чи  (терминальная  и  файловая), то могут
возникнуть  неясности  с флагом "КОНТРОЛЬ
СКОРОСТИ".
   Если  флаг  сброшен, то никаких вопро-
сов, но если установлен, то:

  * если абонент перешёл на другую ско-
      рость, работая в терминале, то
      изменится "терминальная" скорость.

  * если  абонент  начал  передавать или
      принимать файлы на другой скорости,
      то изменится "файловая" скорость.

  * если "терминальная" скорость выключе-
      на (стоит "-----"), то всегда изме-
      няется "файловая" скорость.


         ИНДИКАТОР СТАТУСА ЛИНИИ

   Справа вверху экрана имеется индикатор
статуса линии, там вывоодться "Off_l" или
текущая  скорость.  Если  указана "терми-
нальная"  скорость,  то  всегда выводится
именно  она. И ТОЛЬКО во время приема/пе-
редачи выводиться "файловая" скорость.

              ЦВЕТА СИСТЕМЫ

   Единственное затруднение может вызвать
последний (34-й) цвет, назыаемый "Измене-
ние цвета при выборе".
   Когда  Вы выбираете какую-либо опцию в
окнах,  то  выбраная строка изменяет свой
цвет. Цвет выбранной опции - это цвет са-
мого  окна  объединенный  по XOR с данной
опцией.
   И вот в этой опции Вы указываете _как_
будет  изменяться цвет: изменится/нет ЯР-
КОСТЬ, как изменится цвет ФОНА и СИМВОЛОВ

                 ОШИБКИ

   Во время работы с программой частенько
случаются  обломы...  В этом случае будет
выведена  строка " WARNING!! ERROR! " , а
под  ней вылезет строчка с объяснением об
обломе. Т.к. мне лень описывать сообщения
об ошибках, то они выводятся по-русски.

  Если  Вы  открыли какое-то окно, то при
приеме любого символа от абонента в линию
будет выдано сообщение "АБОНЕНТ ЗАНЯТ". А
когда  Вы закроете все окна , в линию бу-
дет  выдано сообщения "АБОНЕНТ ОСВОБОДИЛ-
СЯ".
     Эта программа была опробирована
        на следующих компьютерах:

  - SCORPION ZS 256
  - PENTIUM-133 ... бр-р-р! Pentagon-128
  - KAY-256
  - Turbo 2+
  - Profi
  - Нечто самодельное

  И, как ни удивительно, всё работало...
             _____

            Ну вот вроде и всё

   +===============================+
   |К этому МОДЕМУ имели отношение:|#
   +===============================+#
    #################################

 - Основная идея : *KSV*
   (812) 263-12-89 Сергей Кузьмин

 - Программа : *MAS*
   (812) 583-54-48 Александр Майоров

 - Музыкальные фрагменты : Arno
   (812) 186-13-58 Алексей Михайлов

 - Тестирование : маленькая кучка народу.

            Если Вам программа
        понравилась,то Вы можете :

 1) пользоваться программой

 2) пользоваться программой ;-)

 3) позвонить авторам и выразить свою
    благодарность. Но можно и не звонить,
    а перевести на счет авторов некую
    сумму денег. А номер такой :
            счет : ША92Т62315
      отдел. сбербанка : N1876 0502


          Если Вам программа не
       понравилась, то Вы можете :

 1) не пользоваться программой

 2) сделать FORMAT DISK

 3) см.  пункт  3 в разделе ПОНРАВИЛОСЬ.
;-)


   Если Вы что-то не поняли,
 или если Вы ничего не поняли,
то Вы можете позвонить АВТОРАМ
 и что-нибудь спросить у них.

  Телефоны были указаны выше
      ( ^ где-то там ^ )


      Все ошибки и очипятки сделаны
   специально, или их никто не заметил.

_________________________________________