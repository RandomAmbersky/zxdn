Из дистрибутива Quick Commander v3.11



    Эта  версия  была  сделана  на  скорую  руку  путем обычного
переноса   части   процедур  из  еще  незавершенного  QC  4.00 в
исходники  QC  3.10.  Зачем?  Потому  что  несмотря  на  то  что
принципиально   новая  версия  QC  4.00  имеет  большую  степень
готовности,  ее  релиз  состоится  еще  не  скоро (я сам не знаю
когда). А Znahar прислал мне спрайтовый вьювер, который он хотел
увидеть  в  составе  QC  как можно быстрее. Спрайтовый вьювер от
Znahar  +  новая версия вьювера из QC 4.00 + поддержка резидента
TR-DOS  6.10e  +  bugfixes  =  QC  3.11.  На  мой  взгляд вполне
приличный повод для новой версии. ;)


                       История изменений:

[!] - Важное изменение!
[+] - Новое
[*] - Сделано лучше/изменено
[-] - Исправлен баг
[?] - скорее хуже, чем лучше

(В скобках указаны авторы предложенных изменений)


    :: Version 3.11 (sprite viewer)
    :: Date: 15.04.2006 - 28.04.2005

[!] Спрайтовый  вьювер! Горячая кнопка SS+V. Подробное  описание
    смотрите ниже. (big thanx to Znahar)
[!] Резидент  теперь  находится  не в 7-ой странице, а в #C7 (по
    пентагоновскому    стандарту   расширенной   памяти),   плюс
    добавлена метка "Residentpresent!" по адресу #FFF0 благодаря
    чему  программы  поддерживающие  подобные резиденты, а это в
    первую очередь TR-DOS 6.xxe, будут запускать QC после выхода
    в TR-DOS по нулевому адресу.
[+] Viewer: поддержка табуляции (код 9).
[+] Viewer: добавлен  третий  режим   Mode:  текст  черно-белый,
    символы цветов заменяются на пробелы.
[*] Viewer: ускорена  процедура  определения  кодировки  (теперь
    работает  только  для  первых  16384 байт файла) и процедура
    генерации таблицы строк (в 1.5-2 раза).
[*] Viewer: фоновая  генерация  таблицы  строк:  после  загрузки
    файла  строится таблица для первых 23-х строк, они выводятся
    на  экран,  а  пока пользователь смотрит на первую страницу,
    строится таблица всех строк текста.
[*] Viewer: шрифт изменен для совместимости с US Anti64.
[-] Viewer: строки >256 симоволов неверно выводились.
[-] Viewer: при выходе из вьювера стек уменьшался на 2.
[-] Viewer:  баг  при  Mode=ч/б  если  загрузить файл и включить
    цвета (Mode=цв.).
[-] Если  в  сетапе  задан цвет маркированных файлов не #78, был
    глюк при переименовании.
[-] После  Save boot, копия  на диске не использовала сохранение
    настроек в резиденте.


    :: Version 3.10 (new viewer)
    :: Date: xx.11.2004 - 22.01.2005

[!] Абсолютно  новый  текстовый  вьювер!  Переписан с нуля и как
    обычно   меньше   и   функциональнее  предыдущего.  Все  что
    перечислено ниже касается только вьювера.
[+] Поддержка цветов по стандарту ACEdit. Кнопкой M (Mode) можно
    отключить.
[+] Поддержка 3 разных разделителей строк: #0D, #0D#0A, #0A.
[+] 3  разных  режима  подсчета процентов: для маленьких текстов
    (точно),  больших (грубо) и очень больших (примерно). Раньше
    был только примерный подсчет.
[*] Счетчик  процентов  считает  не по байтам, а по строкам, что
    более корректно.
[*] 2  разных  режима переноса строк выступающих за края экрана:
    простой   и   "умный",  когда  находится  символ-разделитель
    (например пробел) и строка переносится после него.
[*] Вся  информация  и управление собраны в одной информационной
    строке, а значит на экран влазит на 1 строку больше.
[?] Нет поддержки табуляции (временно).
[?] Нет возможности "двигать" экран влево/вправо.
[?] Ограничение  на   общее  количество  строк  в  тексте:  5461
    (среднестатический   текст   длиной   65535   байт  содержит
    1000-2000 строк).
[?] Вьювер не работает в 48Кб.


    :: Version 3.05 (more settings)
    :: Date: 03.12.2004 - 03.01.2005

[!] Сильно  модифицирован  сетап  (который  в  basic  части QC).
    Появилось   много   новых   настроек   (см.   ниже),  убраны
    комментарии (рекомендуется настройку осуществлять при помощи
    Quick  Setup).  Настройки  разделены  на  2  части:  те  что
    изменяются  во  время  работы  QC и неизменяемые. Изменяемые
    настройки  сохраняются  в  CMOS  ячейках  и в резиденте, при
    запуске   QC   из   резидента,   Shadow   RAM  или  ПЗУ  они
    восстанавливаются.  Восстанавливается:  исходящий и входящий
    дисководы, текущее меню, позиция курсора, режим вывода всего
    каталога, скорость упаковки, зацикливание мелодий.
[+] Для каждого дисковода настраивается скорость чтения и записи
    (в   сетапе).  Выбранная  скорость  видна  по  цвету  иконок
    дисководов  (в  правом верхнем углу): для медленной скорости
    они зеленые, для быстрой желтые.
[+] Выбор   способа   загрузки   QC   (в  сетапе):  при   помощи
    турбозагрузчика или через #3D13.
[+] Выбор разных режимов работы CMOS (в сетапе). (Prusak)
[+] Новые "цветные" расширения в сетапе: .V и .v для музыкальных
    модулей Vortex Tracker II. Теперь общее число раскрашиваемых
    расширений достигло 26.
[*] Кнопка  "S"  в  файловом  меню  теперь  выбирает не скорость
    записи, а скорость упаковки встроенным паковщиком.
[*] Обновлен  встроенный  PT3-player  до  версии  r6. (thanks to
    Sergey Bulba)
[*] В резидент добавлен запрет прерываний. (Looker)
[*] При запуске QC устанавливается IM1.
[-] При инсталяции в 32Кб Shadow RAM запись производилась только
    в одну половинку. (Prusak)
[-] На  скорпионах  использовалась  8-я страница, а на остальных
    клонах не использовалась, хотя должно было быть наоборот.


    :: Version 3.04 (memory driver)
    :: Date: 11.11.2004 - 22.11.2004

[!] Сильно  переделан  драйвер  памяти. Добавлена  поддержка ATM
    Turbo2+  (128..1024К),  KAY  1024К  (раньше  только  512К) и
    Pentagon 4М (первый мегабайт). Также изменен алгоритм поиска
    доступных  страниц,  что  позволит находить страницы с самой
    причудливой адресацией.
[+] Добавлена  поддержка  CMOS  часов  по схеме SMUC. (thanks to
    Pawel Kislyak)
[+] В  сетапе  появилась  возможность  отключить  работу  с CMOS
    часами и выбрать их тип. (Prusak)
[*] Обновленная  версия  встроенного   плэйера  ProTracker  3.xx
    мелодий. (thanks to Sergey Bulba)
[*] Вернулась назад возможность прерывать запуск файла break'ом.
    (kyv^3umf)
[-] Исправлена   ошибка   из-за   которой  прошлая   версия   не
    проигрывала  мелодии,  если  модуль располагался не с начала
    файла. (kyv^3umf)
[-] Еще  одна  ошибка  прошлой  версии:  если   при   завершении
    проигрывания мелодии будет автоматически совершен переход на
    картинку или шрифт, то сработает переход на следующий файл.


    :: Version 3.03 (play!)
    :: Date: 20.09.2004 - 15.10.2004

[!] Абсолютно  новый  плэйер  ProTracker  v3.xx  мелодий. Данный
    плеер  во время инициализации определяет номер версии модуля
    и  генерирует  необходимые таблицы громкости и нот. Также во
    время   проигрывания   работает   один  из  двух  алгоритмов
    портаменто (старый для версии 3.5 и ниже, и новый для 3.6+ и
    Vortex  Tracker II), звук в точности соответсвует звучанию в
    редакторе.  При  всем  этом  плеер  занимает  намного меньше
    места! Огромное спасибо автору плэйера Сергею Бульбе.
[+] Поддержка новой сигнатуры мелодий ProTracker "Vortex Tracker
    II  1.0  module"  предложенной   автором   Vortex  Tracker'а
    Сергеем  Бульбой. Поиск мелодий теперь производится сразу по
    двум сигнатурам.
[+] Поддержка   CMOS   часов   по   стандарту  Gluk.  Если  часы
    обнаружены,  то  в  углу  экрана  выводится  текущее  время.
    (thanks to Pawel Kislyak)
[+] Сохранение  в  CMOS  часах позиции курсора, режима панелей и
    текущего  дисковода. При запуске QC из ПЗУ или из Shadow RAM
    они восстанавливаются (это не касается "обычного" запуска QC
    с диска).
[*] Из-за  необходимости  вывода  часов  изменен вид отображения
    режимов   проигрывания   мелодий.  "Fast  play"  (ускоренное
    проигрывание)   теперь  отображается  как  просто  "Fast", а
    "antiLoop"   (запрет   зацикливания  мелодий)  превратился в
    "Loop" (если напечатано, тогда зацикливание разрешено).


    :: Version 3.02 (correct)
    :: Date: 31.05.2004 - 13.09.2004

[+] Плэйер музыки теперь определяет в какой версии Pro Tracker'а
    был  написан музыкальный модуль и использует соответствующюю
    таблицу   громкости.  Применен  алгоритм  Ивана  Рощина  для
    генерации разных таблиц громкости. Исходник модифицированной
    версии плэйера MIC367hi прилагается вместе с QC.
[+] В  сетапе  можно  задать  дорожку  и  сектор в которые будет
    записываться  каталог  при  выполнении  Keep  и  Auto  Keep.
    (TaE^SC)
[+] При  выполнении  операции  Show  теперь  не просто выводится
    надпись  совпадают  ли  каталоги,  но  и отображается первая
    страница сохраненного каталога.
[*] Вход во встроенный вьювер ускорен.
[*] Счетчик процентов во вьювере стал корректнее считать. (Pawel
    Kislyak)
[-] Не работала правая кнопка мыши во вьювере и пункт меню Exit.


    :: Version 3.01 (more!)
    :: Date: 12.05.2004 - 19.05.2004

[!] Кнопка  Enter в файловом меню теперь запускает файлы (раньше
    маркировала). Кнопка U упразднена. (Александр Морозов)
[+] Мгновенный  выход  из  просмотра   картинок  и  текстов  (не
    работает в 48К).
[+] Переименование файлов по маске. Горячая кнопка CS+R. Если на
    диске  нет  маркированных файлов, предлагается отмаркировать
    файлы  по  маске.  После  надо ввести маску по которой будет
    происходить переименование файлов. (Looker)
[+] При   запуске   файлов,  в  резиденте  запоминается  текущий
    дисковод,  позиция курсора и меню, а при возврате в QC (если
    программа  это  поддерживает),  они восстанавливаются. (MaXx
    Fomkin)
[+] Новая кнопка для маркировки файлов - Graph (CS+9).
[+] При  переименовании  файлов  и  задании масок, кнопкой Graph
    (CS+9)  можно  быстро  переместиться  на расширение файла (и
    обратно на первую позицию). (Looker)
[*] При  маркировке/размаркировке  файлов по маске кнопка Delete
    стирает символы не пробелом, а "решеткой".
[*] При   маркировке/размаркировке   файлов   по   маске,  маска
    запоминается.
[*] При Hrust/Unhrust файлов теперь пишется не "Save into file",
    а "Hrust file" и "Unhrust file".
[?] Выкинут   метод   store  из  упаковщика  и  особая  упаковка
    basic-файлов. Толку мало, а места занимали прилично.
[-] При  упаковке  и просмотре текстов с длиной кратной 256, она
    неверно определялась.
[-] При запуске кодовых файлов, вместо нулей были точки.
[-] Пункт  файлового  меню "run" не запускал файлы, а маркировал
    их.


    :: Version 3.00 (new design)
    :: Date: 26.10.2003 - 28.04.2004

[!] Новый  дизайн под 51 символ в строке. (thanks to Wizard/DT &
    Mentat/OB)
[+] Имена  файлов  теперь  выводятся  вместе  с  3-х символьными
    расширениями.
[+] По scrollbar'у можно "кликать" мышкой.
[*] Пунктов меню стало больше, и они стали более информативными.
[*] Надписи   в   информационной   панели   распределены   более
    рационально, плюс теперь выводится общее количество файлов.
[*] Информация о файле под курсором приобрела понятный вид.
[*] Scrollbar и информация о файле под курсором теперь выводятся
    и в главном меню.
[*] Мгновенная  маркировка/размаркировка всех файлов и файлов по
    маске.
[*] Нету  "моргания"  экрана (из-за очистки) при перепечатывании
    каталога.
[*] "Прозрачный" курсор.  Виден  цвет  файла,  на  котором стоит
    курсор.
[*] Обновлен PT3-player до версии MIC367h.
[*] Во   время  проигрывания  музыки  текущие  режимы  выводятся
    надписями, а не значками.
[*] Режим   fastPlay  теперь  не  отключается  после  завершения
    проигрывания.
[*] После  всех  выводимых  в  нижней строке надписей поставлены
    точки.
[*] При   удалении   одного   файла  под  курсором,  он  сначала
    маркируется.
[*] При  запуске  QC,  если  диска  в  дисководе  нет, в  памяти
    создается образ чистого диска (2544 секторов).
[*] При  форматировании  диска  в  качестве  имени  предлагается
    пустое.
[?] Уменьшен  размер  хелпа и списка отличий. Гигантомания сюксь
    (C) Alone Coder.
[-] Зависание  при  попытке  проигрывать  мелодию  длиной  в   1
    позицию.
[-] Во вьювере счетчик процентов мог заехать за 100%.
[-] Более  корректное  определение  длины  файла  в  байтах  при
    просмотре файлов.
[-] При Copy/Move корректнее вычисляется текущая страница.
[-] Надпись "Incorrect disc" переправлена на "Incorrect disk".


                 -            -------
-             -  -- ---------  ---- ------------              -
--------     --        -    ---------       ------------     --
  ------------                  -  -   --         ------------
      -  --- -                     -                  -  --- -


                     Подробная информация:


    Quick   Commander  (далее  QC)  использует  прямой  доступ к
контроллеру  дисковода  КР1818ВГ93,  поэтому не будет работать с
винчестером.


    :: Запуск коммандера

    Если  у  вас  установлено  теневое ОЗУ (Shadow RAM) размером
16Кб  или  32Кб, то вы можете загрузить в него QC и после этого,
простым   нажатием   кнопки   Magic,   мгновенно  запускать  его
практически  из  любой программы. Для загрузки QC в теневое ОЗУ,
держите  кнопку  I  (Install)  во  время  запуска QC. В ответ QC
моргнет   border'ом  зеленого  цвета.  После  этого,  вы  можете
запускать QC кнопкой Magic.
    Так  же существует возможность прошить QC вместо Basic 128 в
ПЗУ,  тогда  при нажатии на кнопку Reset будет сразу запускаться
QC. Для этого в комплекте прилагается файл QC_3_nn.rom.
    QC  сохраняет  некоторые  свои настройки в память CMOS часов
Используются байты #10, #15, #16. В них сохраняется: исходящий и
входящий  дисководы, текущее меню, позиция курсора, режим вывода
всего  каталога,  скорость  упаковки,  зацикливание мелодий. При
запуске  QC  из  ПЗУ,  Shadow RAM или из резидента эти настройки
восстанавливаются.   Работу  с  часами  CMOS  можно  отключить в
сетапе, там же можно выбрать их тип.
    QC  поддерживает расширенную память Scorpion, KAY, Pentagon,
АТМ1,  АТМ  Turbo+,  Profi. На Scorpion в сетапе можно настроить
чтобы не используется 8-я страница (с теневым монитором). Также,
можно  настроить чтобы не использовалась 7-я страница (в которой
находится резидент QC).
    Если  у вас больше 128Кб памяти и вы по каким-то причинам не
хотите  чтобы  QC  использовал  ее, удерживайте во время запуска
кнопку W (Without). QC запустится в режиме 128Кб.
    Если  у вас имеется 1Мб памяти по стандарту Pentagon, то для
того,  чтобы  QC  ее  определял, удерживайте Caps shift во время
запуска коммандера, иначе будет проверяться только 512Кб.


    :: Запуск файлов

    В  главном  меню  на экране отображаются только basic-файлы.
Чтобы  их запустить достаточно нажать Enter (или 0) или кликнуть
левой  кнопкой  мыши.  В файловом меню файлы запускаются кнопкой
Enter и мышью при помощи пункта "run".
    Для  быстрого запуска первых 22 файлов в главном меню, можно
использовать  горячие  кнопки  (напечатаны  слева  от  имен этих
файлов). Некоторые горячие кнопки пересекаются с кнопками QC (C,
N, T, R, S), тогда их следует нажимать удерживая Caps shift.
    Если курсор стоит на basic-файле (расширение ".B"), он будет
немедленно  запущен.  Если  же  курсор  стоит не на basic-файле,
предлагается  выбрать  2  адреса:  адрес  по которому файл будет
загружен  и  адрес  с  которого файл будет запущен. Адреса могут
быть   заданы   в  диапазоне  0..65535  (никаких  дополнительных
проверок (что это за адреса) нет, так что вполне можете затереть
загрузчик  и  повиснуть). При запуске: экран и память очищаются,
стек  устанавливается  равным #5FE4, включается нулевая страница
памяти.
    При  запуске  файлов,  в  резиденте запоминается исходящий и
входящий  дисководы, текущее меню, позиция курсора, режим вывода
всего  каталога,  скорость упаковки, зацикливание мелодий, а при
возврате   в   QC   (если   программа   это  поддерживает),  они
восстанавливаются.
    Запуск  производится  без  помощи  basic-процедур, благодаря
чему  можно  запускать  удаленные  файлы  и  файлы с одинаковыми
именами.


    :: Управление

    Перемещение  курсора осуществляется кнопками Q, A, O, P и 6,
7,  8,  9,  а  также  курсорными клавишами. Нажатие Enter (и 0 в
главном  меню) приведет к запуску файла на котором стоит курсор.
Пробел переключает между файловым и главным меню.

    Снизу  экрана  находится  строка  с  подсказкой по возможным
операциям   из  текущего  меню.  "Горячие  кнопки"  вызова  этих
операций напечатаны прописными (большими) буквами. Например, для
вызова  операции  копирования  (Copy)  нужно нажать кнопку С. По
пунктам подсказки можно "кликать" мышкой.

    Везде работают следующие горячие кнопки:

    1,   2,  3,  4  -  выбор  рабочего  дисковода  (A,  B,  C, D
соответственно). Об  выбранном  дисководе свидетельствует кнопка
зеленого цвета в верхнем правом углу.

    Symbol  shift  +  1, 2, 3, 4 - выбор A, B, C, D дисковода на
который будет производиться копирование.

    5 (5-reread) - перечитать каталог диска.

    Home (SS+Q) - переместить курсор в начало каталога.

    End (SS+E) - переместить курсор в конец каталога.

    K  (autoKeep)  -  включение/выключение  режима autoKeep. При
этом,  на  диск  записывается/стирается специальная метка "Quick
Commander"  в  0-ую  дорожку.  При  включенном  режиме  autoKeep
(когда  на  диске  имеется  метка),  после  выполнения  операций
изменяющих   каталог   диска   происходит   автоматическое   его
сохранение   на   161-ю   дорожку.   Каталог  сохраняется  после
выполнения  следующих операций: rename file, rename disk, delete
files,  move  disk,  merge  files,  copy files, save boot, hrust
file, unhrust file.

    I   (Info)   -   отображение  количества  памяти  и  размера
выделенных файлов в секторах/килобайтах.

    Y - вывод информации об авторе QC.

    Если  у  вас  есть  3-я  кнопка  на  мышке,  тогда  можно ее
использовать для перечитывания каталога диска.


    :: Главное меню

    Горячие кнопки используемые в главном меню:

    N  (diskName)  -  переименование диска. Задаются 11 символов
имени  диска.  В этом режиме: кнопки "влево", "вправо" - двигать
курсор,  Delete  -  стирание  символа,  Edit mode - переключение
русские/английские    буквы,    Caps    Lock    -   переключение
большие/маленькие  буквы,  Home  (SS+Q)  -  курсор в начало, End
(SS+E)  - курсор в конец. Русский режим ввода букв реализован по
раскладке  ЯВЕРТЫ: буквы ч, э, ш, щ, ю вызываются кнопками a, s,
f,  g,  x  с  нажатым  Symbol shift. Extend mode и правая кнопка
мыши - выйти из режима переименования, Enter и левая кнопка мыши
- сохранить новое имя диска.

    C  (Care_menu)  -  войти  в  меню  работы с диском. Описание
смотрите ниже.

    R  (Run_in_48k)  -  запустить файл на котором стоит курсор в
режиме  48Кб. При запуске устанавливается 5-ый бит #7FFD, в порт
расширения памяти (если он есть) записывается 0.

    T (Tr-dos) - быстрый выход в TR-DOS из коммандера.

    S  (Saveboot) - сохранение резидентной копии QC, находящейся
в памяти, на диск с именем "boot.B". При сохранении, выбранные в
коммандере  настройки (статус режима Fast/Slow save) сохраняются
в этой копии. Сохранение может быть невозможно, если резидентная
копия  была  затерта  при  копировании  файлов  или  на диске не
хватает  места. В этом случае, коммандер мигнет красным бордером
и отменит действие.


    :: Файловое меню

    При входе в это меню, надпись с количеством памяти изменится
на   "Buff:nnnn",   где  nnnn  -  объем  памяти,  которая  будет
использована при операциях Copy и Move.

    В  отличии  от  предыдущего режима где все файлы были одного
цвета,  при входе в режим работы с файлами, все файлы выделяются
различными цветами, в зависимости от своего типа. Различаются 26
групп   файлов.  Все  цвета  можно  самостоятельно  настроить  в
сетапе коммандера.

    В  сетапе  можно  настроить  скорость  чтения  и  записи для
каждого  дисковода.  Выбранная  скорость  видна  по цвету иконок
дисководов  (в  правом верхнем углу): для медленной скорости они
зеленые, для быстрой желтые.

    Перед  выполнением  операций связанных с изменением каталога
диска  (copy,  move, delete, rename, merge, hrust, unhrust, save
boot)   происходит   сравнение   каталога  диска  вставленного в
дисковод  и  каталога находящегося в памяти коммандера. Если они
отличаются,  операция  будет  отменена,  а  вы увидите на экране
надпись   Incorrect   disk.  После  этого  каталог  диска  будет
автоматически перечитан.

    В   окошке   с  индикацией  режимов  отображается  следующая
информация:

    "resid"  -  в 7-ой странице памяти находится резидент QC. Он
может быть затерт при операциях Copy и Move.
    "Slowpack"  (или  "faStpack")  показывают выбранную скорость
упаковки.   В  режиме  Slow  упаковка  осуществляется  медленнее
примерно  в  2  раза,  но  часто  более качественно. Скорость по
умолчанию можно задать в сетапе QC.
    "fullCat"  -  показывает,  что  включен режим просмотра ВСЕХ
128-и  файлов  каталога.  Это  может  быть  полезно для работы с
удаленными файлами. Режим fullCat включается/выключается горячей
кнопкой F.
    "aKeep" - показывает, что включен режим autoKeep.

    Остальные горячие кнопки:

    Graph (CS+9) и 0 - маркировать файл под курсором.

    True video (SS+3) - перейти к следующей странице с файлами.

    Inv video (SS+4) - перейти к предыдущей странице с файлами.

    C  (Copy)  - копирование файлов. Если нет отмеченных файлов,
будет  скопирован  файл, на  котором  стоит  курсор. Копирование
происходит  с  учетом  последовательности, в  которой файлы были
отмечены.  В процессе копирования, в правом нижнем углу рисуются
"квадратики", отображая степень выполнения операции. Верхний ряд
"квадратиков" показывает процесс чтения, нижний процесс записи.

    M  (Move)  -  уплотнить  диск. Работает только если на диске
есть удаленные файлы. В процессе уплотнения в правом нижнем углу
рисуются  "квадратики",  отображая  степень  выполнения. Если на
диске   есть   отмаркированные  файлы,  тогда  уплотнение  будет
производится  ТОЛЬКО  среди  тех файлов, которые находятся после
первого отмаркированного файла в каталоге.

    D  (Delete)  или  E  (Erase)  -  удаление  файлов.  Если нет
отмеченных файлов, будет удален файл, на котором стоит курсор.

    R  (Rename)  - переименование файла на котором стоит курсор.
Работает  аналогично  переименованию  диска  из  главного  меню.
Если  в  удаленном  файле  вместо  "решетки" ввести какой-нибудь
символ, то этот файл восстановится. Обратите внимание, что имена
файлов можно написать русскими буквами. При этом QC будет с ними
работать  так  же как и с остальными файлами, но TR-DOS с такими
файлами работать не сможет.

    G  (merGe)  -  "склеить"  отмеченные файлы. Между файлами не
должно  быть  удаленных  или  неотмеченных файлов. Если отмечено
больше   255  секторов,  то  будет  создано  несколько  файлов с
одинаковыми именами, но различными расширениями.

    V  (View) - если курсор стоит на @-файле (длина 192 сектора)
или на экранном файле (длина 6144 или 6912 байт), то вы попадете
в режим просмотра картинок. В этом режиме Space или левая кнопка
мыши  -  изменение цветов картинки, Enter - переход к следующему
файлу  (см.ниже),  остальные  кнопки - возврат в коммандер. Если
файл  относится  к  шрифтам  (длина 768 или 2048 байт), то будет
запущен  режим  просмотра  шрифтов.  Если  же  файл,  на котором
находится  курсор  не подходит под признаки картинки или шрифта,
то запустится текстовый вьювер. Его описание смотрите ниже. Если
же   вы   хотите   принудительно   запустить  текстовый  вьювер,
независимо от принадлежности файла, используйте комбинацию CS+V.
Поддерживается  просмотр картинок, шрифтов и текстов упакованных
при  помощи  Hrust  v2.x.  Для этого упакованные и распакованные
файлы  не должны быть больше 32768 байт (в 48Кб режиме не больше
16180 байт).

    Z  (muZ)  -  поиск  в  указанном  файле музыки в формате Pro
Tracker  v3.x (поиск осуществляется по сигнатурам "ProTracker" и
"VortexTracker").  Мелодия может быть компилированной или нет, с
плэйером  или без него. При нахождении в указанном файле музыки,
она  сразу  начнет проигрываться. Поиск возможен в файлах длиной
до 255 секторов. При проигрывании мелодии, в нижних двух строках
пишется  информация  о  названии  мелодии  и ее авторе, в правом
нижнем   углу   отображаются   индикаторы   музыки.   Во   время
проигрывания музыки можно использовать следующие кнопки:

    B (Begin) - начать проигрывание мелодии сначала.
    F (Fastplay) - трехкратное ускорение проигрывания мелодии.
    L (Loop) - включение/отключение  зацикливания  мелодий. Если
      эта надпись не  горит, то  при  завершении  мелодии  будет
      осуществлен  автоматический  переход  к следующему файлу в
      каталоге (или к следующему маркированному, если они  есть,
      смотрите ниже про Enter).
    P (Pause) - включить/выключить паузу.
    Enter - переход к следующему файлу (см.ниже).
    Все остальные кнопки - возврат в коммандер.

    Во время инициализации плэйер определяет номер версии модуля
и  генерирует  необходимые  таблицы  громкости  и  нот. Также во
время  проигрывания  работает один из двух алгоритмов портаменто
(старый для версии 3.5 и ниже, и новый для 3.6+ и Vortex Tracker
II), звук в точности соответсвует звучанию в редакторе.

    Поддерживается  проигрывание  музыки  упакованной при помощи
Hrust  v2.x.  Для  этого  упакованные  и  распакованные файлы не
должны  быть  больше  32768  байт (в 48Кб режиме не больше 16383
байт).

    ПРИМЕЧАНИЕ:  при нажатии на Enter в режимах View и muZ, если
на  диске  есть отмаркированные файлы, то курсор переместится на
следующий  из  них,  если  маркированных  файлов  нет, то курсор
переместится  на  следующий в каталоге файл. После этого в файле
будет  произведен  поиск музыки, картинок и шрифтов. Если ничего
подобного    не    найдено,    запускается    текстовый   вьювер
(просмоторщик) для просмотра этого файла.

    H  (Hrust)  -  упаковка файла по алгоритму Hrust v2.4 (автор
упаковщика   Hrumer,   исправление  потери  плотности  паковки и
добавление  алгоритма lazy evaluation by Alone Coder). На запрос
необходимо указать имя выходного файла. Если процесс ввода имени
прервать,  упаковка  файла отменяется. Упаковываемые файлы могут
быть  размером  до  32768  байт (128 секторов). Прервать процесс
упаковки  можно  кнопкой  A (Abort). Упаковка не работает в 48Кб
режиме.  В случае возникновения ошибок (нет места на диске или в
каталоге,  файл  слишком  большой,  используется 48Кб режим), QC
моргнет  красным  бордером.  Возможно ускорение упаковки в 1.5-2
раза  за  счет отключения алгоритма lazy evaluation, что ухудшит
степень   сжатия.  Как  отключить  смотрите  в  описании  сетапа
коммандера.

    N (uNhrust) - распаковка файлов упакованных при помощи Hrust
v2.x.  На  запрос  необходимо  указать имя выходного файла. Если
процесс  ввода  имени  прервать,  распаковка  файла  отменяется.
Упакованные  и  распакованные  файлы должны быть не больше 32768
байт (в 48Кб режиме не больше 16180 байт). Используется 2 метода
распаковки:  если  выходной  файл  будет  меньше  16384  байт он
распакуется  быстро,  в противном случае медленно (затрачивается
время  на  расчистку  памяти  под буфер). В случае возникновения
ошибок  (нет  места  на  диске  или  в  каталоге,  файл  слишком
большой), QC моргнет красным бордером.

    Если  дважды кликнуть левой кнопкой мышки по названию файла,
в  файле будет произведен поиск музыки, картинок и шрифтов. Если
ничего   подобного  не  найдено,  запускается  текстовый  вьювер
(просмоторщик) для просмотра этого файла.

    + или L (в меню - m+) - отметить все файлы (с уже отмеченных
снимется маркировка).

    CS+L  -  маркировать  файлы  по  маске.  В  ответ на запрос,
необходимо  задать  маску  для  файлов.  В этой маске символ "."
обозначает   любой   символ.  После  нажатия  Enter,  все  файлы
подходящие под маску, будут отмечены (с отмеченных маркировка не
снимается).

    -  или X (в меню - m-) - снять маркировку со всех отмеченных
файлов.

    CS+X  -  снять  маркировку  с  файлов  по  маске. В ответ на
запрос,  необходимо  задать  маску  для  файлов.  В  этой  маске
символ  "."  означает любой символ. После нажатия Enter, со всех
файлов  подходящих  под  маску, будет снята маркировка (если она
была).

    CS+R  -  переименование  файлов  по маске. Если на диске нет
маркированных  файлов,  предлагается сначала отмаркировать файлы
по  маске.  После  чего  надо  ввести  маску  по  которой  будет
происходить переименование файлов.

    :: Меню работы с диском

    Вход  в  этот  режим из главного меню осуществляется кнопкой
C (Care).

    Горячие кнопки:

    K  (Keep  catalog)  -  сохранить  каталог  на 161-ой дорожке
(обычно  неиспользуемой). Если диск отформатирован больше чем на
160  дорожек  и на 161-ой дорожке находятся файлы, то QC моргнет
красным border'ом, сигнализируя об ошибке, и сохранение каталога
будет отменено.

    S  (Show  differents)  -  сравнить  исходный  и  сохраненный
каталоги.  В  результате  выполнения будет написано: Directories
are  different  (каталоги  разные)  или Directories are matching
(каталоги одинаковые).

    E  (rEstore  catalog) - переписать ранее сохраненный каталог
со  161-ой  дорожки  на  0-ую.  Перед  использованием этой опции
убедитесь,  что  на  161-ой  дорожке имеется сохраненный каталог
(опцией  Show),  иначе вы рискуете необратимо уничтожить каталог
на дискете.

    C  (Check  disk)  -  быстрая пpовеpка диска. При обнаружении
сбоя  попытается восстановить дорожку. Сопровождается привычными
"квадратиками"   в   углу  экрана,  которые  показывают  степень
выполнения операции.

    R  (Restore disk) - отреставрировать диск. Полезно при плохо
читаемых дискетах. Также, если дискета была отформатирована не в
QC,  то  можете и ее отреставрировать этой опцией, при этом диск
преобразуется  в специальный формат с которым программы работают
заметно быстрее.

    ПРИМЕЧАНИЕ:  Check  disk  и  Restore  disk можно начать не с
начала  диска,  а с конкретного файла. Для этого в меню работы с
файлами  отметьте  файл  с  которого  необходимо  начать работу,
возвращайтесь в меню Care и запускайте требуемую операцию.

    F  (Format  disk) - форматирование диска. Сразу предлагается
ввести  имя  диска  (11  символов).  Если вы откажетесь от ввода
имени (нажав Extend mode или правую кнопку мыши), форматирование
будет   прервано.   В   противном   случае,   СРАЗУ   начинается
форматирование.       Степень       выполнения      отображается
квадратиками-анализаторами  в  правом  нижнем  углу  экрана.  QC
форматирует  диск  С КОНЦА ДИСКА К НАЧАЛУ. Диск форматируется на
2544 сектора (80 дорожек, две стороны).


    :: Текстовый вьювер

    Текстовый  вьювер  обеспечивает просмотр любых файлов длиной
до 255 секторов, в любой из 3-ех кодировок (win1251, KOI8-R, DOS
cp866)  и  с  любыми разделителями строк (#0D, #0D0A, #0A). Если
файл  занимает  ноль  секторов, то для просмотра будет загружено
255 секторов.
    Автоматически  определяется  кодировка текста в 95% случаев.
Если  определение  отработало  неверно,  вы можете принудительно
изменить  кодировку  текста при помощи режима Convert (подробнее
смотрите ниже).
    Поддерживается   раскраска   текста   по  стандарту  ACEdit.
Отключить раскрашивание текста можно кнопкой M (Mode).
    Цвет  информационной  панели  и цвет по умолчанию для текста
можно изменить в сетапе коммандера.
    Вьювер  не работает на 48Кб! Также есть ограничение на общее
количество   строк   в  тексте:  5461  (среднестатический  текст
длиной 65535 байт содержит 1000-2000 строк).

    Управление во вьювере:

Вверх по строкам текста:              9, Q, up
Вниз по строкам текста:               8, A, down
Вверх по страницам текста:            True video, left
Вниз по страницам текста:             Inv. video, Space, right
Перейти в начало текста:              Home (SS+Q)
Перейти в конец текста:               End (SS+E)
Переход к следующему файлу(чит.ниже): Enter
Включить/выключить автоперенос строк  W (Wrap)
Конвертировать текст:                 C (Convert)
Включить/выключить поддержку цветов:  M (Mode)
Включить/выключить звук:              S (Sound)
Вернуться в QC:                       Edit mode, Extend mode или
                                      правая кнопка мыши

    При   перемещении   по   тексту,   в  информационной  строке
печатается текущая позиция в процентах от всего текста.

    Конвертер   текста   (Convert,   горячая   клавиша  C)  дает
возможность  прочесть  текст  в  одной  из  следующих кодировок:
windows (win1251), KOI8-R, DOS (cp866). При нажатии C происходит
замена  фонта,  которым  вьювер  печатает  текст. При нескольких
нажатиях   кнопки   C,   кодировки   переключаются  "по  кругу".
Используемая  в  данный  момент  кодировка текста отображается в
информационной строке.

    Доступны  2 разных режима переноса строк выступающих за края
экрана:  простой  и  "умный", когда находится символ-разделитель
("  ",  "!",  "?",  "-",  ":", ";", ".", ",", "/", "\") и строка
переносится  после  него.  Переключение  режимов  осуществляется
кнопкой  W (Wrap). При этом в информационной строке можно видеть
текущий  режим:  <=>  означает  отсуствие  переноса  строк,  >=<
означает что часть строки выступающая за край экрана переносится
на   следующую   строку,   >W<   означает   что   перенос  строк
осуществляется по символу разделителю.

    При управление мышкой во вьювере можно нажимать по элементам
информационной  строки:  имя файла - переход к следующему файлу,
DOS (WIN, KOI) - переключение кодировок текста, >=< (>=<, >W<) -
переключение режимов переноса строк.

    Экран с текстом условно разделен на 4 части:

                   ----T---------------T---¬
                   ¦   ¦               ¦   ¦
                   ¦   ¦       3       ¦   ¦
                   ¦ 1 +---------------+ 2 ¦
                   ¦   ¦       4       ¦   ¦
                   ¦   ¦               ¦   ¦
                   L---+---------------+----

    Нажатие  курсором  на  1-ом  поле  приведет к перемещению по
страницам вверх. На 2-ом поле - к перемещению по страницам вниз.
На  3-ем  поле  -  к перемещение вверх построчно. На 4-ом поле к
перемещение вниз построчно.


    :: Спрайтовый вьювер
 
    Вызывается  нажатием  сочетания  кнопок  symbol  shift  + V.
Внешний вид в целом совпадает с текстовым вьювером.

    Управление в спрайтовом вьювере:

Вверх на 8 линий:                     Q, up
Вниз на 8 линий:                      A, down
Вверх на 1 линию:                     8
Вниз на 1 линию:                      9
Вверх на 1 байт:                      6
Вниз на 1 байт:                       7
Уменьшение ширины спрайта:            O, left
Увеличение ширины спрайта:            P, right
Перейти в начало спрайта:             Home (SS+Q)
Перейти в конец спрайта:              End (SS+E)
Переход к следующему файлу:           Enter
Включить/выключить звук:              S (Sound)
Вернуться в QC:                       Edit mode, Extend mode или
                                      правая кнопка мыши


    :: Настройка коммандера

    Вы   можете   изменить   установки   по  умолчанию,  которые
используются  в  QC,  для  этого  вам  понадобится утилита Quick
Setup  (автор  Looker).  Также  настройку  можно  произвести при
помощи  любого дискового доктора. Найдите начало файла "QС 3.xx"
и  среди  кода  загрузчика  по  смещению  23  (#17) идут байты с
настройками (ниже кусок исходника QC):

        ;0-2: output drive
        ;3: 1 - pack with LE, 0 - simple pack.
        ;4: 1 - fullcat off, 0 - fullcat on.
        ;5: 1 - QC config ID, 0 - RC config ID.
        ;6: 1 - play without loop, 0 - loop on.
        ;7: 1 - boot mode, 0 - commander mode.
CONFIG  DB %10111000

        ;0: 1 - fast load QC, 0 - slow load (#3D13).
        ;1: 1 - smart use resident, 0 - don't use.
        ;2: 1 - Use CMOS, 0 - don't use.
        ;3: 1 - Gluk CMOS, 0 - SMUC CMOS.
        ;4: 1 - read & write CMOS, 0 - read only CMOS.
        ;5: 1 - skip page 8 on scorpion, 0 - no skip.
        ;6: reserved
        ;7: reserved
CONFIG2 DB %11111111

        ;0: 1 - fast load, 0 - slow load: Drive A.
        ;1: 1 - fast save, 0 - slow save: Drive A.
        ;2: 1 - fast load, 0 - slow load: Drive B.
        ;3: 1 - fast save, 0 - slow save: Drive B.
        ;4: 1 - fast load, 0 - slow load: Drive C.
        ;5: 1 - fast save, 0 - slow save: Drive C.
        ;6: 1 - fast load, 0 - slow load: Drive D.
        ;7: 1 - fast save, 0 - slow save: Drive D.
            ;D C B A
CONFDRV DB %11111111

KEEP_TS DW #A107

COLORSF DB #47,#07,#43             ;B C s
        DB #45,#45,#45,#45,#45,#45 ;m M v V S w
        DB #44,#44,#44,#44         ;W t T d
        DB #02,#42,#42,#42,#42     ;p z Z r h
        DB #05,#05,#05,#05,#05     ;H R a A X
COLORSO DB #04,#01,#06             ;scr del oth
COLORS  DB #5F,#78,#05,#30

    Пояснения:

    1-ый  и  2-ой  содержат  настройки  по  умолчанию для разных
режимов.
    3-ий  байт  (метка  CONFDRV) задает скорость чтения и записи
для  каждого  дисковода:  в  режиме  fast скорость выше в ~1.5-2
раза,  но  возможна  некорректная запись на медленных дисководах
(если  вы работаете под эмулятором рекомендуется всегда включать
fast),   при  slow  гарантируется  корректная  запись  на  любых
дисководах     за    счет    дополнительной    задержки    после
позиционирования.
    2  байта  (KEEP_TS)  задают дорожку и сектор в которые будет
записываться каталог диска операциями Keep и Auto Keep.
    В  COLORSF  задаются  23  цвета  для соответствующих цветных
расширений.
    В  COLORSO  цвета  для  экранных файлов и шрифтов, удаленных
файлов, файлов не попавших ни под одно известное расширение.
    В  COLORS размещены настройки цветов самого QC: цвет курсора
на  маркированном  файле, цвет маркированных файлов, цвет текста
по умолчанию во вьювере, цвет информационной полосы во вьювере.

    Резидент  нужен  для работы опции "Save boot" и для быстрого
возврата в коммандер из программ поддерживающий выход с запуском
QC:

        LD BC,#7FFD
        LD A,#D7 ;(не #17!!!)
        OUT (C),A
        LD HL,(#C000)
        LD DE,#FF31
        XOR A
        SBC HL,DE
        JP Z,#C000
        LD H,A
        LD L,A
        PUSH HL
        LD A,#10
        OUT (C),A
        JP #3D2F

                 -            -------
-             -  -- ---------  ---- ------------              -
--------     --        -    ---------       ------------     --
  ------------                  -  -   --         ------------
      -  --- -                     -                  -  --- -


                         Благодарности:

         Max Petrov - концепция, первоначальный код QC
           Hrumer, Alone Coder - код упаковщика Hrust
           Sergey Bulba - код плэйера ProTracker 3.xx
             DarkMax - код scrollbar и анализаторов
              Nick Patlaenko - код турбозагрузчика
                Znahar - код спрайтового вьювера
                 Pawel Kislyak - обмен кодом ;)
                   Looker - автор Quick Setup
                   Jeffie - оформление хелпа
                     Mentat - дизайн, шрифт
                         Wizard - шрифт
                          Keetar - logo


                 -            -------
-             -  -- ---------  ---- ------------              -
--------     --        -    ---------       ------------     --
  ------------                  -  -   --         ------------
      -  --- -                     -                  -  --- -


                   Дополнительная информация:

    Автор  программы  Андрей  Богданович  aka  Spectre. QC будет
продолжать  развиваться  до  тех  пор  пока  я  получаю про него
отзывы.   Пожелания   по  работе  QC  всегда  приветствуются  по
электронному адресу: spectre@tut.by.


                 -            -------
-             -  -- ---------  ---- ------------              -
--------     --        -    ---------       ------------     --
  ------------                  -  -   --         ------------
      -  --- -                     -                  -  --- -
